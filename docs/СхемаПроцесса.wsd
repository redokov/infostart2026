@startuml FieldWorksPlanningProcessPart1
' Элементы сверху вниз (удобно для печати на А4)
top to bottom direction
skinparam ranksep 10
skinparam dpi 80
skinparam packageTitleAlignment left

skinparam usecase {
  BackgroundColor LightPink
}
skinparam note {
  BackgroundColor LightBlue
}
skinparam rectangle {
  BackgroundColor LightGray
}

usecase/ S.0 as "Начало процесса"

usecase Ф.1 #AAFFAA as "
Агроном отделения
====
Сформировать технологические 
карты
----
П-001"
note left of Ф.1
**Технологическая карта (ТК)** по культуре/полю/периоду:
- перечень операций 
(вспашка/посев/внесение/обработка/уборка)
- нормы: семена, СЗР, удобрения, ГСМ, вода
- техника/агрегаты, трудозатраты
- календарные окна выполнения
end note

usecase/ С.1 as "Технологические\n карты подготовлены"

usecase Ф.2 #AAFFAA as "
Учетчик
====
Собрать ТК от всех отделений
----
П-002"
note left of Ф.2
Каналы получения:
- из ERP/агроучета
- Excel/почта (с последующей загрузкой)
Контроль: наличие всех полей, культур и сезонов.
end note

usecase/ С.2 as "Комплект ТК собран"

usecase Ф.3 #AAFFAA as "
Главный агроном
====
Проверить полноту и корректность ТК
----
П-003"
note left of Ф.3
Проверки:
- операции не противоречат технологии
- нормы и сроки реалистичны
- поля/площади актуальны
- единицы измерения и справочники согласованы
end note

usecase У.1 as (**XOR**)

usecase/ С.3 as "ТК корректны"
usecase/ С.4 as "Найдены замечания"

usecase Ф.4 #AAFFAA as "
Агроном отделения
====
Доработать ТК по замечаниям
----
П-004"
note left of Ф.4
Фиксируются версии ТК:
- **Черновик** → 
  **На согласовании** → 
  **Согласовано по работам**
end note

usecase/ С.5 as "ТК доработаны"

usecase Т.1 as "**1**"

S.0 -d-> Ф.1
Ф.1 -d-> С.1
С.1 -d-> Ф.2
Ф.2 -d-> С.2
С.2 -d-> Ф.3
Ф.3 -d-> У.1
У.1 -d-> С.3
У.1 -d-> С.4
С.4 -d-> Ф.4
Ф.4 -d-> С.5
С.5 -d-> Ф.3

С.3 -d-> Т.1
@enduml


@startuml FieldWorksPlanningProcessPart2
top to bottom direction
skinparam ranksep 10
skinparam dpi 80
skinparam packageTitleAlignment left

skinparam usecase {
  BackgroundColor LightPink
}
skinparam note {
  BackgroundColor LightBlue
}
skinparam rectangle {
  BackgroundColor LightGray
}

usecase Т.1 as "**1**"

usecase/ С.6 as "ТК согласованы по работам"

Т.1 -d-> С.6

usecase Ф.5 #AAFFAA as "
Экономист / ПЭО
====
Рассчитать потребность и стоимость по ТК
----
П-005"
note left of Ф.5
Формируется **плановая калькуляция**:
- материалы (семена/СЗР/удобрения)
- ГСМ и услуги
- амортизация/ремонт/аренда техники (если применяется)
- ФОТ (если учитывается в бюджете)
Результат: бюджет по статьям и периодам.
end note

usecase/ С.7 as "Плановая стоимость рассчитана"

usecase Ф.6 #AAFFAA as "
Руководитель производства
====
Согласовать объемы и календарь работ
----
П-006"
note left of Ф.6
Проверка:
- выполнимость по технике и персоналу
- пересечения по пиковым периодам
- приоритеты по культурам/полям
end note

usecase/ С.8 as "План работ согласован"

usecase Ф.7 #AAFFAA as "
Финансовый директор
====
Согласовать бюджет полевых работ
----
П-007"
note left of Ф.7
Согласование по деньгам:
- лимиты на период/статьи
- план закупок и график платежей
Статусы бюджета:
**Черновик** → **На согласовании** → **Утвержден** / **На доработке**
end note

usecase У.2 as (**XOR**)

usecase/ С.9 as "Бюджет утвержден"
usecase/ С.10 as "Требуется доработка бюджета"

usecase Ф.8 #AAFFAA as "
Экономист / ПЭО
====
Доработать ТК и бюджет
----
П-008"
note left of Ф.8
Причины доработки:
- превышены лимиты
- изменились цены/наличие материалов
- корректировка площадей/структуры посевов
end note

usecase/ С.11 as "Доработанный бюджет готов"

usecase Т.2 as "**2**"


С.6 -d-> Ф.5
Ф.5 -d-> С.7
С.7 -d-> Ф.6
Ф.6 -d-> С.8
С.8 -d-> Ф.7
Ф.7 -d-> У.2
У.2 -d-> С.9
У.2 -d-> С.10
С.10 -d-> Ф.8
Ф.8 -d-> С.11
С.11 -d-> Ф.7

С.9 -d-> Т.2
@enduml


@startuml FieldWorksPlanningProcessPart3
top to bottom direction
skinparam ranksep 10
skinparam dpi 80
skinparam packageTitleAlignment left

skinparam usecase {
  BackgroundColor LightPink
}
skinparam note {
  BackgroundColor LightBlue
}
skinparam rectangle {
  BackgroundColor LightGray
}

usecase Т.2 as "**2**"

usecase/ С.12 as "План и бюджет доведены\n до исполнителей"

usecase Ф.9 #AAFFAA as "
Диспетчер / начальник участка
====
Выдать задания на смену 
(наряды/маршруты)
----
П-009"
note left of Ф.9
Задание включает:
- поле/культура/операция
- плановый объем
(га/т/км)
- техника и экипаж
- лимит ГСМ/материалов
(если применяется)
end note

usecase/ С.13 as "Задания выданы"

usecase Ф.10 #AAFFAA as "
Механизатор / бригада
====
Выполнить полевые работы
----
П-010"

usecase/ С.14 as "Работы выполнены (факт на месте)"

usecase Ф.11 #AAFFAA as "
Диспетчер / учетчик ГСМ
====
Собрать первичные
документы по факту
----
П-011"
note left of Ф.11
Источники факта:
- **путевые листы** 
(маршрут/время/моточасы/пробег)
- **заправочные ведомости** 
(дата/техника/выдано/остаток)
- акты выполненных работ
(при подрядчиках)
- данные GPS/телематики
(если используются)
end note

usecase/ С.15 as "Первичка собрана"

usecase Ф.12 #AAFFAA as "
Бухгалтерия / оператор ERP
====
Отразить факт в системе учета
----
П-012"
note left of Ф.12
Ввод и контроль:
- привязка к полю/операции/культуре/технике
- списание материалов и ГСМ
- статусы документов: **Черновик** → 
  **Проведен** → 
  **Закрыт период**
end note

usecase/ С.16 as "Фактические данные\n отражены в системе"

usecase Т.3 as "**3**"

Т.2 -d-> С.12
С.12 -d-> Ф.9
Ф.9 -d-> С.13
С.13 -d-> Ф.10
Ф.10 -d-> С.14
С.14 -d-> Ф.11
Ф.11 -d-> С.15
С.15 -d-> Ф.12
Ф.12 -d-> С.16
С.16 -d-> Т.3
@enduml


@startuml FieldWorksPlanningProcessPart4
top to bottom direction
skinparam ranksep 10
skinparam dpi 80
skinparam packageTitleAlignment left

skinparam usecase {
  BackgroundColor LightPink
}
skinparam note {
  BackgroundColor LightBlue
}
skinparam rectangle {
  BackgroundColor LightGray
}

usecase Т.3 as "**3**"

usecase/ С.17 as "Доступен план и факт\n по работам/затратам"

usecase Ф.13 #AAFFAA as "
Контролер / ПЭО
====
Сопоставить план и 
факт (объемы и деньги)
----
П-013"
note left of Ф.13
Сравнение в разрезах:
- поле / культура / операция
- период (неделя/месяц)
- ресурсы (ГСМ, материалы, техника, подряд)
Выход: отчет **План–Факт** и список отклонений.
end note

usecase У.3 as (**XOR**)

usecase/ С.18 as "Отклонений нет или\n в пределах нормы"
usecase/ С.19 as "Есть существенные\n отклонения"

usecase Ф.14 #AAFFAA as "
Главный агроном + экономист
====
Разобрать причины отклонений 
и предложить меры
----
П-014"
note left of Ф.14
Примеры причин:
- погода / перенос сроков
- перерасход ГСМ (маршруты, простои)
- изменение норм внесения/обработок
- изменение цен/дефицит материалов
end note

usecase/ С.20 as "Корректирующие \nдействия согласованы"

usecase Ф.15 #AAFFAA as "
ПЭО / диспетчерская
====
Внести корректировки 
в план/бюджет (если требуется)
----
П-015"
note left of Ф.15
Оформляется изменение:
- обновление ТК/лимитов
- перепланирование календаря работ
- корректировка заявок на закупку
end note

usecase/ С.21 as "План актуализирован\n и опубликован"

usecase Ф.16 #AAFFAA as "
Руководитель производства
====
Закрыть период и 
утвердить отчетность
----
П-016"

usecase/ S.99 as "Конец процесса"

Т.3 -d-> С.17
С.17 -d-> Ф.13
Ф.13 -d-> У.3
У.3 -d-> С.18
У.3 -d-> С.19

С.19 -d-> Ф.14
Ф.14 -d-> С.20
С.20 -d-> Ф.15
Ф.15 -d-> С.21
С.21 -d-> Ф.13

С.18 -d-> Ф.16
Ф.16 -d-> S.99
@enduml